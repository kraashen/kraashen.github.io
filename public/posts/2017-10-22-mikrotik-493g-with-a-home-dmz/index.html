<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='In the previous post I showed one way to set up a home network using Mikrotik Routerboard. Next up in my project list was to set up a Raspberry Pi web server to host my own website and a blog (this one in fact). This required some tweaks to my home network set up as I needed to allow access to a device in my network from the public Internet.'>

<meta property='og:title' content='Mikrotik 493G with a Home DMZ • tracing bytes'>
<meta property='og:description' content='In the previous post I showed one way to set up a home network using Mikrotik Routerboard. Next up in my project list was to set up a Raspberry Pi web server to host my own website and a blog (this one in fact). This required some tweaks to my home network set up as I needed to allow access to a device in my network from the public Internet.'>
<meta property='og:url' content='http://example.com/posts/2017-10-22-mikrotik-493g-with-a-home-dmz/'>
<meta property='og:site_name' content='tracing bytes'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:published_time' content='2017-10-22T02:37:22&#43;03:00'/><meta property='article:modified_time' content='2017-10-22T02:37:22&#43;03:00'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@tomihj'>

<meta name="generator" content="Hugo 0.29" />

  <title>Mikrotik 493G with a Home DMZ • tracing bytes</title>
  <link rel='canonical' href='http://example.com/posts/2017-10-22-mikrotik-493g-with-a-home-dmz/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Ubuntu:400,400i,700&subset=latin'>
<link rel='stylesheet' href='/assets/css/main.bc2171e3.css'>
</head>


<body class='page type-posts'>
  <div class='site'>

    <a class='screen-reader' href='#main'>Skip to Content</a>

    <header id='header' class='header-container'>
      <div class='header site-header'>
        <nav id='main-menu' class='main-menu-container' aria-label='Main Menu'>
  <ul class='main-menu'>
  <li>
      <a href='/'>Home</a>
    </li>
  
  </ul>
</nav>

        <div class='header-info'>
          
          <p class='site-title title'>tracing bytes</p>
          
          <p class='site-description subtitle'>programming and tech journeys, stack traces, and bits of bytes</p>
        </div>
      </div>
    </header>


<main id='main' class='main'>
  <article lang='en' class='entry'>
    <header class='header-container'>
  <div class='header entry-header'>
    <div class='header-info'>
      <h1 class='title'>Mikrotik 493G with a Home DMZ</h1>
      

    </div>
    
<div class='meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader'>Posted on </span>
  <time class='date' datetime='2017-10-22T02:37:22&#43;03:00'>2017, Oct 22</time>
</span>

  
  

</div>


  </div>
</header>

    
    

    <div class='entry-content'>
  

<p>In the <a href="../2017-10-15-setting-up-mikrotik-493g-as-a-home-router-wlan-ap/">previous post</a> I showed one way to set up a home network using Mikrotik Routerboard. Next up in my project list was to set up a Raspberry Pi web server to host my own website and a blog (this one in fact). This required some tweaks to my home network set up as I needed to allow access to a device in my network from the public Internet. As Mikrotik allows nice configurability to do this kind of set ups, I dove into some of Mikrotik&rsquo;s own manuals to start up with. One solution to this could be a DMZ, for instance.</p>

<p>In <em>really</em> short, DMZ (&ldquo;demilitarized zone&rdquo;) means either a physical or logical network in which are services that are facing an untrusted network. In this case, it would be a web server.
My goal was to isolate my server(s) from my home network at least on Layer 3 level.</p>

<p>In addition to the previous setup, I&rsquo;d need a separate subnet and firewall rules to isolate the DMZ. Lets go and dive in:</p>

<pre><code># start by redefining the dmz interface name for clarity
/interface ethernet set [find name=ether9] name=dmz


# define a private IPv4 address space
/ip address add address=10.0.0.1/24 interface=dmz


# finally add firewall rules to allow traffic from and to the dmz if it is either
# entering the dmz or the hosts in dmz are accessing the internet.
# allow HTTP and HTTPS traffic.

/ip firewall filter
add chain=forward in-interface=dmz out-interface=ether1 action=accept
add chain=forward out-interface=dmz protocol=tcp dst-port=80,443 action=accept
</code></pre>

<p>As the network is NATted, <strong>Dstnatting</strong> (destination NATting, which I explained in the <a href="../2017-10-15-setting-up-mikrotik-493g-as-a-home-router-wlan-ap/">previous post</a>), is needed as <a href="https://en.wikipedia.org/wiki/Port_forwarding">port forwarding</a> to allow access from the Internet to the server in a local network. Next, access to 80 and 443 ports will is set like:</p>

<pre><code>/ip firewall nat 
add chain=dstnat in-interface=ether1 dst-port=80,443 protocol=tcp action=dst-nat to-addresses=[web-server-address]
</code></pre>

<p>This should be enough for basic home network routing and isolation of the DMZ. If more interfaces are needed, they can be added as slaves to the dmz master port which in this case is <code>ether9</code>. One of the cases that I thought was that even if this kind of firewalling is implemented and if the traffic would be allowed to the server directly from LAN without passing through the Internet, would the local network compromise their existence to the server by connecting using private IP address ranges?</p>

<h2 id="conclusions">Conclusions</h2>

<p>This time I went through a quick introduction of creating a DMZ in a home network using a Mikrotik Routerboard. Now that there is some sparkling dust and magic network segregation in place, next I&rsquo;ll continue to take a look at the installation and configuration of a Raspberry Pi as a web server.</p>

</div>

    
<footer class='entry-footer-container'>
  <div class='entry-footer'>
  
  </div>
</footer>


  </article>
  
<nav class='entry-nav-container'>
  <div class='entry-nav'><div class='prev-entry'>
      <a href='/posts/2017-10-15-setting-up-mikrotik-493g-as-a-home-router-wlan-ap/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader'>Previous post: </span>Setting up MikroTik 493G as a home router (&#43;WLAN AP)</a>
    </div></div>
</nav>

  
</main>

    <footer id='footer' class='footer-container'>
      <div class='footer'>
        <div class='social-menu-container'>
  <nav aria-label='Social Menu'>
    <ul class='social-menu'><li>
        <a href='https://github.com/anerani' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://facebook.com/tomijunt' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Facebook account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/tomihj' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='mailto:erani@iki.fi' target='_blank' rel='noopener'>
          <span class='screen-reader'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/tomijuntunen' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</div>
        <div class='copyright'>
  <p>
        
      

       &copy; 2017 Tomi Juntunen 
  </p>
</div>

      </div>
    </footer>

  </div><script src='/assets/js/main.f29c93b9.js'></script></body>

</html>

